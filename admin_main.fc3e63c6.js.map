{"mappings":"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","sources":["src/js/admin-page.js","src/js/services/promoAPI.js","src/js/promo-admin.js","src/js/services/markupAPI.js","src/js/order-module-admin.js"],"sourcesContent":["import axios from 'axios';\n\nconst logoutButton = document.querySelector('#logoutButton');\nconst spinnerLoader = document.querySelector('.spinner-border');\n\nconst instanceLogout = axios.create({\n  baseURL: 'https://flexyplanner.onrender.com/auth/logout',\n  headers: {\n    Authorization: `Bearer ${window.sessionStorage.getItem('accessToken')}`,\n  },\n});\n\nconst logout = async () => {\n  spinnerLoader.style.display = 'inline-block';\n  try {\n    await instanceLogout.post('', {});\n    window.location.href = '/login.html';\n    window.sessionStorage.removeItem('accessToken');\n  } catch (error) {\n    if (error.response.status === 401) {\n      window.location.href = '/login.html';\n      window.sessionStorage.removeItem('accessToken');\n    }\n  } finally {\n    spinnerLoader.style.display = 'none';\n  }\n};\n\nlogoutButton.addEventListener('click', logout);\n","import axios from 'axios';\n\nconst instancePromocode = axios.create({\n  baseURL: 'https://flexyplanner.onrender.com',\n  headers: {\n    Authorization: `Bearer ${window.sessionStorage.getItem('accessToken')}`,\n    // Authorization: `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiI2M2I4NWJjNDdmMDBlYTAwMzRjNGQ1ZGUiLCJzaWQiOiI2M2MxY2Y5YTEyNmYzNDAwMzQzMTdhZWQiLCJpYXQiOjE2NzM2NDU5NzksImV4cCI6MTY3MzY0OTU3OX0.n4Mx9rkeSBK1z7cC6EjvhwWpZzE8jhH4g63CyGaQLCs`,\n  },\n});\n\nexport const getAllPromocodes = async () => {\n  const { data } = await instancePromocode.get('/promo/');\n  return data;\n};\n\nexport const postPromocodesCreate = async promoData => {\n  const response = await instancePromocode.post('/promo', promoData);\n  return response.data;\n};\nexport const patchPromocodeStatus = async promocode => {\n  const response = await instancePromocode.patch('/promo', promocode);\n  return response.data;\n};\nexport const deletePromocode = async promocode => {\n  const response = await instancePromocode.delete('/promo', promocode);\n  return response.data;\n};\n","import {\n  getAllPromocodes,\n  postPromocodesCreate,\n  patchPromocodeStatus,\n  deletePromocode,\n} from './services/promoAPI';\nimport { Notify } from 'notiflix';\nconst initForm = document.querySelector('.promocode__form');\nconst inputAmount = document.querySelector('.input-amount-js');\nconst dateGroup = document.querySelector('.date__wrapper');\nconst commonList = document.querySelector('.common-promocode');\nconst personalList = document.querySelector('.personal-promocode');\nconst startDate = document.querySelector('#dateStart');\nconst stopDate = document.querySelector('#dateTo');\nconst spinnerLoaderPromo = document.querySelector('.promo-spinner-js');\nconst commonShowBtn = document.querySelector('.btn-show-common-js');\nconst personalShowBtn = document.querySelector('.btn-show-personal-js');\n\nconst promocodeObj = {};\n\nstartDate.value = todayDate();\nstopDate.value = todayDate();\n\nfunction todayDate() {\n  const date = new Date();\n  let day = date.getDate();\n  let month = date.getMonth() + 1;\n  const year = date.getFullYear();\n\n  if (month < 10) month = '0' + month;\n  if (day < 10) day = '0' + day;\n  const today = year + '-' + month + '-' + day;\n  return today;\n}\n\nfunction onFormChange(e) {\n  e.preventDefault();\n  let promoType = e.currentTarget.elements.promocode.value;\n  if (promoType === 'Personal') {\n    if (inputAmount.disabled) inputAmount.disabled = false;\n    dateGroup.classList.add('visually-hidden');\n  } else {\n    if (dateGroup.classList.contains('visually-hidden'))\n      dateGroup.classList.remove('visually-hidden');\n    inputAmount.disabled = true;\n  }\n}\n\nasync function onFormSubmit(e) {\n  spinnerLoaderPromo.style.display = 'inline-block';\n  try {\n    e.preventDefault();\n    const form = e.currentTarget;\n    const {\n      elements: { promocode, amount, discount, dateStart, dateTo },\n    } = form;\n    if (promocode.value === 'Personal') {\n      promocodeObj.type = promocode.value;\n      promocodeObj.amount = Number(amount.value);\n      promocodeObj.discount = Number(discount.value);\n    } else {\n      promocodeObj.type = promocode.value;\n      promocodeObj.discount = Number(discount.value);\n      promocodeObj.amount = Number(amount.value);\n      promocodeObj.from = new Date(dateStart.value).toISOString();\n      promocodeObj.to = new Date(dateTo.value).toISOString();\n    }\n\n    const response = await postPromocodesCreate(promocodeObj);\n    if (response.length) {\n      const promo = await getAllPromocodes();\n      createPromocodeMarkup(promo);\n      Notify.success(`Список промокодів успішно оновлено!`);\n    }\n\n    if (inputAmount.disabled) inputAmount.disabled = false;\n    if (dateGroup.classList.contains('visually-hidden'))\n      dateGroup.classList.remove('visually-hidden');\n    form.reset();\n    startDate.value = todayDate();\n    stopDate.value = todayDate();\n  } catch (error) {\n    logout(error);\n  } finally {\n    spinnerLoaderPromo.style.display = 'none';\n  }\n}\n\nfunction onCommonList(e) {\n  if (e.target.nodeName !== 'BUTTON') {\n    return;\n  }\n  const promoEl = e.target.closest('li');\n  const promoName = promoEl.dataset.name;\n  let isDelete = confirm(`Дійсно видалити цей промокод: ${promoName} ?`);\n  if (isDelete) {\n    spinnerLoaderPromo.style.display = 'inline-block';\n    deletePromocode({\n      data: {\n        promocode: promoName,\n      },\n    })\n      .then(data => {\n        if (data.ok == 1) {\n          Notify.failure(`${promoName} успішно видалено!`);\n          promoEl.remove();\n        }\n      })\n      .catch(error => logout(error))\n      .finally(() => (spinnerLoaderPromo.style.display = 'none'));\n  } else {\n    Notify.info(`Видалення ${promoName} відмінено`);\n  }\n}\n\nfunction onPersonalList(e) {\n  if (e.target.nodeName !== 'BUTTON') {\n    return;\n  }\n  const btnName = e.target.dataset.action;\n  const promoEl = e.target.closest('li');\n  const promoName = promoEl.dataset.name;\n  if (btnName === 'delete') {\n    const isDelete = confirm(`Дійсно видалити цей промокод: ${promoName} ?`);\n    if (isDelete) {\n      spinnerLoaderPromo.style.display = 'inline-block';\n      deletePromocode({\n        data: {\n          promocode: promoName,\n        },\n      })\n        .then(data => {\n          if (data.ok == 1) {\n            Notify.failure(`${promoName} успішно видалено!`);\n            promoEl.remove();\n          }\n        })\n        .catch(error => logout(error))\n        .finally(() => (spinnerLoaderPromo.style.display = 'none'));\n    } else {\n      Notify.info(`Видалення ${promoName} відмінено.`);\n    }\n  } else {\n    const isActivate = confirm(\n      `Дійсно активувати цей промокод: ${promoName} ?`\n    );\n    if (isActivate) {\n      spinnerLoaderPromo.style.display = 'inline-block';\n      patchPromocodeStatus({\n        promocode: promoName,\n      })\n        .then(data => {\n          if (data === 'switchPromoStatus') {\n            e.target.disabled = true;\n            e.target.innerText = 'Активовано';\n            Notify.success(`${promoName} успішно активовано.`);\n          }\n        })\n        .catch(error => logout(error))\n        .finally(() => (spinnerLoaderPromo.style.display = 'none'));\n    } else {\n      Notify.info(`Активацію ${promoName} відмінено.`);\n    }\n  }\n}\n\nsetInterval(() => {\n  getAllPromocodes()\n    .then(data => createPromocodeMarkup(data))\n    .catch(error => console.log(error.message));\n}, 1000 * 60 * 60);\n\nfunction createPromocodeMarkup({ common, personal }) {\n  const commonMarkup = common\n    .map(({ discount, promo, period }, i) => {\n      return `<li class=\"list__item\" data-name='${promo}'>\n            <p>Знижка ${discount}%</p>\n            <p>Термін дії: ${period.from\n              .slice(0, 10)\n              .split('-')\n              .reverse()\n              .join('-')} - ${period.to\n        .slice(0, 10)\n        .split('-')\n        .reverse()\n        .join('-')}</p>\n            <div class=\"common__wrapper\">\n            <p>${i + 1}. <span class=\"promo__name\">${promo}</span></p>\n            <button data-action=\"delete\" class=\"btn btn-danger\" type=\"button\">Видалити</button>\n            </div>\n            </li>`;\n    })\n    .join('');\n\n  const fixedPersonalPromocode = personal.reduce((acc, promocode) => {\n    acc[promocode.discount] = acc[promocode.discount] || [];\n    acc[promocode.discount].push(promocode);\n    return acc;\n  }, {});\n  const promocodeMarkUp = Object.entries(fixedPersonalPromocode)\n    .map(list => {\n      return `\n        <p>Знижка ${list[0]}%</p>\n        <ul class=\"list__item\">\n          ${list[1]\n            .map((p, i) => {\n              return `\n                    <li class=\"personal__wrapper\" data-name='${p.promo}'>\n                    <span>${i + 1}. \n                      <span class=\"promo__name\">${p.promo}</span>\n                    </span>\n                    <div class=\"btn-wrapper\">\n                    ${\n                      p.isUsing\n                        ? '<button data-action=\"active\" disabled class=\"btn btn-success\" type=\"button\">Активовано</button>'\n                        : '<button data-action=\"active\" class=\"btn btn-success\" type=\"button\">Активувати</button>'\n                    }\n                    <button data-action=\"delete\" class=\"btn btn-danger\" type=\"button\">Видалити</button></div>\n                    </li>`;\n            })\n            .join('')}</ul>`;\n    })\n    .join('');\n  commonList.innerHTML = commonMarkup;\n  personalList.innerHTML = promocodeMarkUp;\n}\n\nfunction logout(error) {\n  if (error.response.request.status === 401) {\n    alert(`Час сесії минув. Будь ласка, пройдіть повторну авторизацію!`);\n    window.location.href = '/login.html';\n  }\n}\n\n(() => {\n  spinnerLoaderPromo.style.display = 'inline-block';\n  getAllPromocodes()\n    .then(data => {\n      return createPromocodeMarkup(data);\n    })\n    .catch(error => console.log(error.message))\n    .finally(() => (spinnerLoaderPromo.style.display = 'none'));\n})();\n\nfunction onCommonShowBtn(){\n    \n    commonList.classList.toggle('visually-hidden');\n    commonShowBtn.textContent = 'Сховати';\n    if(commonList.classList.contains('visually-hidden')) commonShowBtn.textContent = 'Показати';\n}\n\nfunction onPersonalShowBtn() {\n    \n    personalList.classList.toggle('visually-hidden');\n    personalShowBtn.textContent = 'Сховати';\n    if(personalList.classList.contains('visually-hidden')) personalShowBtn.textContent = 'Показати';\n}\n\ninitForm.addEventListener('change', onFormChange);\ninitForm.addEventListener('submit', onFormSubmit);\ncommonList.addEventListener('click', onCommonList);\npersonalList.addEventListener('click', onPersonalList);\ncommonShowBtn.addEventListener('click', onCommonShowBtn);\npersonalShowBtn.addEventListener('click', onPersonalShowBtn);","import axios from 'axios';\n\nconst instance = axios.create({\n  baseURL: 'https://flexyplanner.onrender.com',\n});\n\nexport const getMarkup = async () => {\n  const { data } = await instance.get('/markup');\n  return data;\n};\n\nexport const toggleActiveOrderModule = async () => {\n  const { data } = await instance.patch('/markup');\n  return data;\n};\n\nexport const setCurrentPrice = async obj => {\n  const { data } = await instance.put('/markup', obj);\n  return data;\n};\n\nexport const getCurrentPriceFromCrm = async () => {\n  const { data } = await instance.get('/crm/offers');\n  return data.data;\n};\n","import {\n  getMarkup,\n  toggleActiveOrderModule,\n  setCurrentPrice,\n  getCurrentPriceFromCrm,\n} from './services/markupAPI';\n\nconst orderAdmin = document.querySelector('.order-admin');\nconst toOrderBtn = document.querySelector('[data-status=\"to-order\"]');\nconst preOrderBtn = document.querySelector('[data-status=\"pre-order\"]');\n// const formToOrder = document.querySelector('.form-to-order');\nconst formPreOrder = document.querySelector('.form-pre-order');\n\n// const showSettedPrice = data => {\n//   if (data.type === 'pre-order') {\n//     document.querySelector(\n//       '.preorder-price-info'\n//     ).innerHTML = `Встановлена ціна: ${data.data.price}, ціна зі знижкою:  ${data.data.preOrderPrice}`;\n//   } else {\n//     document.querySelector(\n//       '.price-info'\n//     ).innerHTML = `Встановлена ціна: ${data.data.price}`;\n//   }\n// };\n\nconst setActiveBtn = async elem => {\n  elem.classList.remove('btn-danger');\n  elem.classList.add('btn-success');\n  elem.innerText = 'Активовано';\n  elem.disabled = true;\n\n  // try {\n  //   const markupResponse = await getMarkup();\n  //   showSettedPrice(markupResponse);\n  // } catch (error) {\n  //   Notify.failure(error.message);\n  // }\n};\n\nconst toggleButtonsClass = async (curr, next) => {\n  try {\n    await toggleActiveOrderModule();\n    setActiveBtn(curr);\n\n    next.classList.remove('btn-success');\n    next.classList.add('btn-danger');\n    next.innerText = 'Активувати';\n    next.disabled = false;\n  } catch (error) {\n    Notify.failure(error.message);\n  }\n};\n\nconst activateOrderModule = e => {\n  if (!e.target.classList.contains('btn-order-js')) {\n    return;\n  }\n  if (e.target.dataset.status == 'pre-order') {\n    toggleButtonsClass(e.target, toOrderBtn);\n  } else {\n    toggleButtonsClass(e.target, preOrderBtn);\n  }\n};\n\n// const handleToOrderSubmit = async e => {\n//   e.preventDefault();\n\n//   const obj = {\n//     type: 'to-order',\n//     data: {\n//       price: e.target.elements.price.value,\n//     },\n//   };\n\n//   try {\n//     const data = await setCurrentPrice(obj);\n//     showSettedPrice(data);\n//   } catch (error) {\n//     Notify.failure(error.message);\n//   }\n// };\n\nconst getPriceFromCrm = async () => {\n  try {\n    const preOrderPriceArray = await getCurrentPriceFromCrm();\n    return preOrderPriceArray;\n  } catch (error) {\n    Notify.failure(error.message);\n  }\n};\n\nconst handlePreOrderSubmit = async e => {\n  e.preventDefault();\n\n  const obj = {\n    type: 'pre-order',\n    data: {\n      price: e.target.elements.price.value,\n      // preOrderPrice: e.target.elements.preOrderPrice.value,\n    },\n  };\n\n  try {\n    const preOrderPriceArray = await getPriceFromCrm();\n    console.log(preOrderPriceArray);\n    const preOrderPrice = preOrderPriceArray.find(item =>\n      item.sku.startsWith('PO')\n    );\n    // console.log(preOrderPrice.price);\n    obj.data.preOrderPrice = Number(preOrderPrice.price);\n\n    console.log(obj);\n    const data = await setCurrentPrice(obj);\n    // console.log(data);\n    showSettedPrice(data);\n  } catch (error) {\n    Notify.failure(error.message);\n  }\n};\n\nasync function getActiveOrderModule() {\n  try {\n    //TODO: тут приходять дані по активному модулю\n    const data = await getMarkup();\n    console.log(data);\n\n    if (data.type === 'pre-order') {\n      setActiveBtn(preOrderBtn);\n    } else {\n      setActiveBtn(toOrderBtn);\n    }\n  } catch (error) {\n    Notify.failure(error.message);\n  }\n}\n\norderAdmin.addEventListener('click', activateOrderModule);\n// formToOrder.addEventListener('submit', handleToOrderSubmit);\nformPreOrder.addEventListener('submit', handlePreOrderSubmit);\ngetActiveOrderModule();\n"],"names":["$2shzp","parcelRequire","$edaca70da584d42c$var$logoutButton","document","querySelector","$edaca70da584d42c$var$spinnerLoader","$edaca70da584d42c$var$instanceLogout","default","create","baseURL","headers","Authorization","window","sessionStorage","getItem","addEventListener","async","style","display","post","location","href","removeItem","error","response","status","$dcf99417cba4c95e$var$instancePromocode","$dcf99417cba4c95e$export$518e31c3b7c4ab1d","data","get","$dcf99417cba4c95e$export$d8301cf5761abfc1","promoData","$dcf99417cba4c95e$export$4e3cbdfb79abcbd7","promocode","patch","$dcf99417cba4c95e$export$51a9ef01c6b3af31","delete","$5171662a74de6712$var$initForm","$5171662a74de6712$var$inputAmount","$5171662a74de6712$var$dateGroup","$5171662a74de6712$var$commonList","$5171662a74de6712$var$personalList","$5171662a74de6712$var$startDate","$5171662a74de6712$var$stopDate","$5171662a74de6712$var$spinnerLoaderPromo","$5171662a74de6712$var$commonShowBtn","$5171662a74de6712$var$personalShowBtn","$5171662a74de6712$var$promocodeObj","$5171662a74de6712$var$todayDate","date","Date","day","getDate","month","getMonth","getFullYear","$5171662a74de6712$var$createPromocodeMarkup","common","personal","commonMarkup","map","discount","promo","period","i","from","slice","split","reverse","join","to","fixedPersonalPromocode","reduce","acc","push","promocodeMarkUp","Object","entries","list","p","isUsing","innerHTML","$5171662a74de6712$var$logout","request","alert","value","setInterval","then","catch","console","log","message","finally","e","preventDefault","currentTarget","elements","disabled","classList","add","contains","remove","form","amount","dateStart","dateTo","type","Number","toISOString","length","$eWCmQ","Notify","success","reset","target","nodeName","promoEl","closest","promoName","dataset","name","confirm","ok","failure","info","btnName","action","innerText","toggle","textContent","$ff59bd22071f5450$var$instance","$ff59bd22071f5450$export$6262ac39523f95f2","$ff59bd22071f5450$export$32075c0ab52da14c","$ff59bd22071f5450$export$c802bd8bb3e2a86a","obj","put","$ff59bd22071f5450$export$e2ff8bfc97d251c5","$c5b7eeec58f7a264$var$orderAdmin","$c5b7eeec58f7a264$var$toOrderBtn","$c5b7eeec58f7a264$var$preOrderBtn","$c5b7eeec58f7a264$var$formPreOrder","$c5b7eeec58f7a264$var$setActiveBtn","elem","$c5b7eeec58f7a264$var$toggleButtonsClass","curr","next","$c5b7eeec58f7a264$var$getPriceFromCrm","price","preOrderPriceArray","preOrderPrice","find","item","sku","startsWith","showSettedPrice","$c5b7eeec58f7a264$var$getActiveOrderModule"],"version":3,"file":"admin_main.fc3e63c6.js.map"}