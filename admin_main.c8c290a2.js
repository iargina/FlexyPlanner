var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},o=e.parcelRequire0562;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in n){var o=n[e];delete n[e];var r={id:e,exports:{}};return t[e]=r,o.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){n[e]=t},e.parcelRequire0562=o);const r=document.querySelector(".promocode__form"),a=document.querySelector(".input-amount-js"),s=document.querySelector(".date__wrapper"),l=document.querySelector(".common-promocode"),d=document.querySelector(".personal-promocode"),i=document.querySelector("#dateStart"),c=document.querySelector("#dateTo"),u={};function p(){const e=new Date;let t=e.getDate(),n=e.getMonth()+1;n<10&&(n="0"+n),t<10&&(t="0"+t);return e.getFullYear()+"-"+n+"-"+t}i.value=p(),c.value=p();!function({common:e,personal:t}){const n=e.map((({discount:e,promo:t,period:n},o)=>`<li class="list__item" data-name='${t}'>\n            <p>Знижка ${e}%</p>\n            <p>Термін дії: ${n.from.slice(0,10)} - ${n.to.slice(0,10)}</p>\n            <div class="common__wrapper">\n            <p>${o+1}. <span class="promo__name">${t}</span></p>\n            <button data-action="delete" class="btn btn-danger" type="button">Видалити</button>\n            </div>\n            </li>`)).join(""),o=t.reduce(((e,t)=>(e[t.discount]=e[t.discount]||[],e[t.discount].push(t),e)),{}),r=Object.entries(o).map((e=>`\n        <p>Знижка ${e[0]}%</p>\n        <ul class="list__item">\n          ${e[1].map(((e,t)=>`\n                    <li class="personal__wrapper" data-name='${e.promo}'>\n                    <span>${t+1}. \n                      <span class="promo__name">${e.promo}</span>\n                    </span>\n                    <div class="btn-wrapper">\n                    <button data-action="active" class="btn btn-success" type="button">Активувати</button>\n                    <button data-action="delete" class="btn btn-danger" type="button">Видалити</button></div>\n                    </li>`)).join("")}</ul>`)).join("");l.innerHTML=n,d.innerHTML=r}({common:[{discount:10,isUsing:null,promo:"48383627",type:"Common",period:{from:"2023-02-03T22:00:00.000Z",to:"2023-04-18T21:00:00.000Z"}},{discount:20,isUsing:null,promo:"38417820",type:"Common",period:{from:"2023-02-03T22:00:00.000Z",to:"2023-04-18T21:00:00.000Z"}}],personal:[{discount:30,isUsing:!1,type:"personal",promo:"sdvsdv",period:null},{discount:30,isUsing:!1,type:"personal",promo:"1dbfd45",period:null},{discount:10,isUsing:!1,type:"personal",promo:"v63sd1v2",period:null},{discount:30,isUsing:!1,type:"personal",promo:"sdv2fd1",period:null},{discount:20,isUsing:!1,type:"personal",promo:"dfvzx",period:null},{discount:20,isUsing:!1,type:"personal",promo:"137dsv5df",period:null}]}),r.addEventListener("change",(function(e){e.preventDefault(),"personal"===e.currentTarget.elements.promocode.value?(a.disabled&&(a.disabled=!1),s.classList.add("visually-hidden")):(s.classList.contains("visually-hidden")&&s.classList.remove("visually-hidden"),a.disabled=!0)})),r.addEventListener("submit",(function(e){e.preventDefault();const t=e.currentTarget,{elements:{promocode:n,amound:o,discount:r,dateStart:l,dateTo:d}}=t;"personal"===n.value?(u.type=n.value,u.amound=o.value,u.discount=r.value,u.period=null):(u.type=n.value,u.discount=r.value,u.discount=o.value,u.period={from:l.value,to:d.value}),console.log(u),a.disabled&&(a.disabled=!1),s.classList.contains("visually-hidden")&&s.classList.remove("visually-hidden"),t.reset(),i.value=p(),c.value=p()})),l.addEventListener("click",(function(e){if("BUTTON"!==e.target.nodeName)return;const t=e.target.closest("li").dataset.name;confirm(`Дійсно видалити цей промокод: ${t} ?`)?console.log(`delete ${t}`):console.log(`do not delete ${t}`)})),d.addEventListener("click",(function(e){if("BUTTON"!==e.target.nodeName)return;const t=e.target.dataset.action,n=e.target.closest("li").dataset.name;if("delete"===t){confirm(`Дійсно видалити цей промокод: ${n} ?`)?console.log(`delete ${n}`):console.log(`do not delete ${n}`)}else{confirm(`Дійсно активувати цей промокод: ${n} ?`)?(console.log(`active ${n}`),e.target.disabled=!0,e.target.innerText="Активовано"):console.log(`do not active ${n}`)}}));var m=o("2shzp");const v=document.querySelector(".order-admin"),f=document.querySelector('[data-status="to-order"]'),y=document.querySelector('[data-status="pre-order"]'),g=document.querySelector(".form-to-order"),b=document.querySelector(".form-pre-order"),$=async e=>{e.classList.remove("btn-danger"),e.classList.add("btn-success"),e.innerText="Активовано",e.disabled=!0;const{data:t}=await m.default.get("https://flexyplanner.onrender.com/markup");(e=>{console.log(e),"pre-order"===e.type?document.querySelector(".preorder-price-info").innerHTML=`Встановлена ціна: ${e.data.price}, ціна зі знижкою:  ${e.data.preOrderPrice}`:document.querySelector(".price-info").innerHTML=`Встановлена ціна: ${e.data.price}`})(t)},h=async(e,t)=>{await m.default.patch("https://flexyplanner.onrender.com/markup"),$(e),t.classList.remove("btn-success"),t.classList.add("btn-danger"),t.innerText="Активувати",t.disabled=!1};v.addEventListener("click",(e=>{e.target.classList.contains("btn-order-js")&&("pre-order"==e.target.dataset.status?h(e.target,f):h(e.target,y))})),g.addEventListener("submit",(async e=>{e.preventDefault();const t={type:"to-order",data:{price:e.target.elements.price.value}};try{await m.default.put("https://flexyplanner.onrender.com/markup",t)}catch(e){console.log(e)}})),b.addEventListener("submit",(async e=>{e.preventDefault();const t={type:"pre-order",data:{price:e.target.elements.price.value,preOrderPrice:e.target.elements.preOrderPrice.value}};try{await m.default.put("https://flexyplanner.onrender.com/markup",t)}catch(e){console.log(e)}})),async function(){try{const{data:e}=await m.default.get("https://flexyplanner.onrender.com/markup");"pre-order"===e.type?$(y):$(f)}catch(e){console.log("something went wrong")}}();
//# sourceMappingURL=admin_main.c8c290a2.js.map
